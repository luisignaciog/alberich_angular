<div class="loading-overlay" *ngIf="loading">
  <mat-spinner></mat-spinner>
</div>

<div class="back">
  <form [formGroup]="formulario">
    <mat-card class="example-card" appearance="outlined">
      <mat-card-header>
        <div style="width: 100%; align-items: center;">
          <div></div>
          <div style="display: flex; flex-direction: column; align-items: center;">
            <mat-card-title>Datos del contacto {{ contact.Name }}</mat-card-title>
          </div>
        </div>
      </mat-card-header>

      <mat-card-content>
        <mat-form-field class="full-width" appearance="outline" [ngClass]="{ 'campo-pendiente': tieneCambioPendiente('Name') }">
          <mat-label>Nombre</mat-label>
          <input matInput placeholder="Nombre" value="contact.Name" formControlName="Name" >
        </mat-form-field>

        <mat-form-field class="full-width" appearance="outline" [ngClass]="{ 'campo-pendiente': tieneCambioPendiente('Name2') }">
          <mat-label>Nombre 2</mat-label>
          <input matInput placeholder="Nombre 2" value="contact.Name2" formControlName="Name2" >
        </mat-form-field>

        <mat-form-field class="full-width" appearance="outline" [ngClass]="{ 'campo-pendiente': tieneCambioPendiente('PhoneNo') }">
          <mat-label>Teléfono</mat-label>
          <input matInput placeholder="Teléfono" value="contact.PhoneNo" formControlName="PhoneNo" >
        </mat-form-field>

        <mat-form-field class="full-width" appearance="outline" [ngClass]="{ 'campo-pendiente': tieneCambioPendiente('EMail') }">
          <mat-label>E-mail</mat-label>
          <input matInput placeholder="E-mail" value="contact.EMail" formControlName="EMail" >

          <mat-error *ngIf="formulario.get('EMail')?.hasError('required')">
            El correo es obligatorio.
          </mat-error>

          <mat-error *ngIf="formulario.get('EMail')?.hasError('email') && !formulario.get('EMail')?.hasError('required')">
            El correo no es válido.
          </mat-error>
        </mat-form-field>

      </mat-card-content>

      <mat-card-actions>
        <div class="footer-content">
          <div class="leyenda-cambios" *ngIf="hayCambiosPendientes">
            <mat-icon color="primary">warning</mat-icon>
            <strong>Cambios pendientes</strong> de validación.
          </div>

          <div class="footer-buttons">
            <button mat-mini-fab color="primary" (click)="save()">
              <mat-icon>check</mat-icon>
            </button>
            <button mat-mini-fab color="primary" style="margin-left: 10px;" (click)="onNoClick()">
              <mat-icon>close</mat-icon>
            </button>
          </div>
        </div>
      </mat-card-actions>
    </mat-card>
  </form>
</div>
